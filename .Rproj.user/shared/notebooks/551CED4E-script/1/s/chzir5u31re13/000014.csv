"0",""
"0","shipments %>%"
"0","  mutate(const = 'Delayed?') %>%"
"0","  filter(!is.na(delayed)) %>% # Remove not delivered orders"
"0","  group_by(delayed, const) %>%"
"0","  summarise(count = n_distinct(X_id)) %>%"
"0","  ungroup() %>%"
"0","  mutate(perc = count/sum(count)) %>% # Criando a visÃ£o percentual"
"0","  plot_ly(y = ~perc, "
"0","          x = ~const,"
"0","          color = ~delayed,"
"0","          type = 'bar') %>%"
"0","  layout(barmode = 'stack') %>%"
"0","  layout(yaxis = list(title = 'Percentage'),"
"0","         xaxis = list(title = ''),"
"0","         title = 'Percentage of delayed orders')"
