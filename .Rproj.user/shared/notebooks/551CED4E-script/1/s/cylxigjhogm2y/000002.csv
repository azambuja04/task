"0",""
"0","shipments_aux <- shipments %>%"
"0","  separate_rows(packages) %>% "
"0","  filter(!packages %in% c('oid', ':', '')) # Unnest and create one row per package"
"0",""
"0","packages_aux <- packages %>% "
"0","  separate_rows(products) %>%"
"0","  filter(!products %in% c('oid', ':', '')) # Unnest and create on row per product"
"0",""
"0","products_per_order <- shipments_aux %>%"
"0","  inner_join(packages_aux, by = c('packages' = 'X_id')) %>% # Join Shipments and Packages data"
"0","  group_by(X_id) %>%"
"0","  summarise(products = n_distinct(products)) %>% # Count # of products whithin each order"
"0","  ungroup() %>%"
"0","  summarise(products_per_order = mean(products))"
"0",""
"0","print(c('In average, each order presents 2.85 products.'))"
"1","[1]"
"1"," ""In average, each order presents 2.85 products."""
"1","
"
